# Football Player Re-Identification
---

### **main.py**
- Main script for detection and tracking using YOLO and DeepSORT.
- **Functioning**:  
  - Loads the YOLO model and DeepSORT tracker.
  - Processes the input video frame by frame.
  - Detects objects, filters by class and confidence, and tracks them.
  - Draws bounding boxes and IDs on each frame.
  - Outputs annotated video or displays it in real-time.

### **main_classic.py**
- Alternative main script using YOLO and the classic SORT tracker.
- **Functioning**:  
  - Similar to `main.py`, but uses the SORT tracker for object tracking.
  - Useful for benchmarking or comparing tracking algorithms.

### **main_threaded.py**
- Multi-threaded version for real-time or summary video processing.
- **Functioning**:  
  - Uses Python threads to separate video reading, processing, and writing/display.
  - Supports stride-based processing for summary videos.
  - Can record a summary or display in real-time, depending on arguments.

### **model_test.py**
- (Optional) Script for testing the YOLO model independently.
- **Functioning**:  
  - Allows for quick evaluation of detection performance on sample frames or videos.

### **models/best.pt**
- YOLO model weights file.
- **Functioning**:  
  - Loaded by the main scripts for object detection.

### **sort/**
- **tracker.py**: Implementation of the SORT tracking algorithm.
- **__init__.py**: Makes the `sort` directory a Python package.

### **output/**
- Stores output videos generated by the scripts.

### **videos/**
- Stores input videos to be processed.

### **requirements.txt**
- Lists all Python dependencies required to run the project.

---

## Usage (without Docker)

### 1. main_threaded.py (Multi-threaded YOLO + DeepSORT tracking)

**Real-time display (no output file):**
```sh
python main_threaded.py --video videos/15sec_input_720p.mp4 --model models/best.pt
```

**Record a summary video (e.g., 10 seconds, every 2nd frame):**
```sh
python main_threaded.py --video videos/15sec_input_720p.mp4 --model models/best.pt --output output/output_t.mp4 --duration 10 --stride 2
```

- `--video`: Path to input video file
- `--model`: Path to YOLO model
- `--output`: Path to save output video (requires `--duration`)
- `--duration`: Seconds to record (0 for live display)
- `--stride`: Process every Nth frame in recording mode

---

### 2. main.py (YOLO + DeepSORT tracking, single-threaded)

**Display results live:**
```sh
python main.py --video videos/15sec_input_720p.mp4 --model models/best.pt
```

**Save output video:**
```sh
python main.py --video videos/15sec_input_720p.mp4 --model models/best.pt --output output/output.mp4
```

- `--video`: Path to input video file
- `--model`: Path to YOLO model
- `--output`: Path to output video file (optional)
- `--conf`: Confidence threshold (default: 0.7)

---

### 3. main_classic.py (YOLO + SORT tracking, single-threaded)

**Display results live:**
```sh
python main_classic.py --video videos/15sec_input_720p.mp4 --model models/best.pt
```

**Save output video (with duration):**
```sh
python main_classic.py --video videos/15sec_input_720p.mp4 --model models/best.pt --output output/output_c.mp4 --duration 10
```

- `--video`: Path to input video file
- `--model`: Path to YOLO model
- `--output`: Path to output video file (optional)
- `--duration`: Duration of output video in seconds (required if saving output)
- `--conf`: Confidence threshold (default: 0.7)

---

## Dependencies

- Python 3.10+
- ultralytics
- opencv-python-headless
- numpy
- deep_sort_realtime
- torch
- ffmpeg (system dependency)
